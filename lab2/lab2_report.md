> University: [ITMO University](https://itmo.ru/ru/)<br/>
> Faculty: [FICT](https://fict.itmo.ru)<br/>
> Course: [Network programming](https://github.com/itmo-ict-faculty/network-programming)<br/>
> Year: 2022/2023<br/>
> Group: K34202<br/>
> Author: Anisova Tatiana Sergeevna<br/>
> Lab: Lab2<br/>
> Date of create: 22.01.2023<br/>
> Date of finished: <br/>

# Описание
В данной лабораторной работе вы на практике ознакомитесь с системой управления конфигурацией Ansible, которая используется для автоматизации настройки и развертывания программного обеспечения.

# Цель работы
С помощью Ansible настроить несколько сетевых устройств и собрать информацию о них. Правильно собрать файл Inventory.

# Ход работы
## 1. Установить второй CHR на своем ПК
Чтобы развернуть вторую виртуальную машину MikroTik RouterOS в VirtualBox, потребовалось изменить ее UUID:

![1](https://user-images.githubusercontent.com/58114563/224985583-d9cbc1f4-7115-4fd2-90f0-0624cb4d8519.png)

## 2. Организовать второй OVPN Client на втором CHR
На второй ВМ был настроен OVPN-клиент по аналогии с первой лабораторной работой, задан адрес 192.168.188.201 (см. схему связи).

## 3. Используя Ansible, настроить сразу на 2-х CHR логин/пароль, NTP Client, OSPF с указанием Router ID
Для работы с Ansible была создана директория /etc/ansible. В ней был создан инвентарный файл hosts:

![hostsnew](https://user-images.githubusercontent.com/58114563/224986947-e4cf956b-f32b-4a6d-8bc1-3c8fb9a31b5e.png)

В этом файле задается группа хостов routers, к которой относятся router1 и router2. Для каждого хоста прописаны логин и пароль, по которым должен подключаться Ansible, а также заданы общие для группы переменные.

После этого потребовалось установить библиотеку libssh и подключиться по ssh к каждому из роутеров, чтобы подтвердить аутентичность хостов.

Чтобы проверить корректность inventory-файла, был запущен пинг хостов:

![Снимок экрана 2023-03-11 001042](https://user-images.githubusercontent.com/58114563/224989302-5fa27a53-662f-4cf0-9edf-4218421724e3.png)

После этого был написан первый плейбук, содержащий команду для создания нового пользователя:

![Снимок экрана 2023-03-04 204558](https://user-images.githubusercontent.com/58114563/224989700-363b91c2-7c76-4b2b-9b7c-67b4fb58e893.png)

Плейбук был успешно запущен:

![Снимок экрана 2023-03-04 202839](https://user-images.githubusercontent.com/58114563/224990053-5be9c07e-4ca2-4a51-9418-00f1a67133f6.png)

Работа плейбука была проверена на стороне роутеров:

![usercheck](https://user-images.githubusercontent.com/58114563/224992524-870e7c11-ab4e-48da-a17a-daa01101b8e1.png)

Далее был написан второй плейбук, где подключается NTP-клиент и указывается адрес сервера, с которым синхронизируется время:

![Снимок экрана 2023-03-04 204930](https://user-images.githubusercontent.com/58114563/224993010-19536fe3-4a5b-4816-8c95-fc8f3cbbea8d.png)

Запуск второго плейбука:

![Снимок экрана 2023-03-04 205111](https://user-images.githubusercontent.com/58114563/224993204-0ff3800f-1d6e-480b-a5eb-d6e7396531cc.png)

Проверка NTP-клиента на роутерах:

![ntpcheck](https://user-images.githubusercontent.com/58114563/224993750-bec53e40-7d41-44f4-84bb-2e4c542396c7.png)

Наконец, третий плейбук для настройки OSPF:

![Снимок экрана 2023-03-10 235849](https://user-images.githubusercontent.com/58114563/224993924-3f68a1f8-d8dc-4d39-a801-65b4e8690796.png)

Здесь создается интерфейс Loopback, используются переменные для задания IP-адресов и Router ID. Создается OSPF-инстанс и OSPF-зона, которая прокидывается на реальный интерфейс.

Запуск третьего плейбука:

![Снимок экрана 2023-03-05 200617](https://user-images.githubusercontent.com/58114563/224996978-11588580-d4e8-47a8-837d-2282cd441cb2.png)

После запуска был открыт Winbox-интерфейс роутера. На вкладке OSPF появился созданный инстанс, интерфейс, зона. Роутеры появились в списке соседей друг у друга, что подтверждает корректность настройки OSPF:

![Снимок экрана 2023-03-05 225246](https://user-images.githubusercontent.com/58114563/224999500-92c9142a-5c7e-4ffb-8999-24a105389657.png)

## 4. Собрать данные по OSPF топологии и полный конфиг устройства

На роутерах был указан файл для экспорта, куда была помещена конфигурация OSPF:
```
export file router#.rsc
routing ospf export compact
```
Полученные файлы приложены к отчету.

# Резульаты работы
+ 2 файла с конфигурациями роутеров
+ Схема связи:

![diagram1 drawio (2)](https://user-images.githubusercontent.com/58114563/225010466-6ab5af1d-a1e4-44e9-ae00-2fcf98d928f3.png)

+ IP-связность:

![Снимок экрана 2023-03-05 234328](https://user-images.githubusercontent.com/58114563/225010563-ceab9122-37ed-4623-984a-724eb7cc31a5.png)
